# Caddyfile 配置模板
# 部署时会根据实际需求处理变量

{
    # 全局配置
    email {env.ADMIN_EMAIL}
    
    # 本地开发时关闭自动 HTTPS
    {% if development_mode | default(false) %}
    auto_https off
    {% endif %}
}

# 默认站点（可根据需要修改）
:80 {
    # 健康检查端点
    handle /health {
        respond "OK" 200
    }
    
    # 静态文件服务（如果有）
    handle /static/* {
        root * /data/uploads
        file_server browse
    }
    
    # 代理到应用服务
    handle /* {
        reverse_proxy http://127.0.0.1:3000
    }
    
    # 访问日志
    log {
        output file /data/caddy/logs/access.log
        format json
    }
}

# 示例：特定域名配置
# {{ domain_name | default('example.com') }} {
#     reverse_proxy http://127.0.0.1:3000
# }

